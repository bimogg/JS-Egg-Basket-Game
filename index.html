<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
    <title>Игра с корзинкой</title>
    <link rel="icon" href="imgs/EB.png" type="image/png" />
    <link rel="stylesheet" href="game.css" />
    <script src="game.js"></script>
  </head>
  <body>
    <!-- Отдельный div для фона - работает в Safari -->
    <div id="backgroundLayer" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-image: url('imgs/background.jpg'); background-size: cover; background-position: center center; background-repeat: no-repeat; z-index: -1; pointer-events: none;"></div>
    <h2>Уровень: <span class="level">1</span></h2>
    <h2>Счет: <span class="score">0</span></h2>
    <h2>Лучший счет: <span class="HighScore">0</span></h2>
    <h2>Время: <span class="timer">60</span>с</h2>
    <div id="gameOverModal" style="display: none;">
      <div class="modal-content">
        <h1>Время вышло!</h1>
        <h2>Вы собрали: <span id="finalScore">0</span> пользователей</h2>
        <button onclick="restartGame()">Играть снова</button>
      </div>
    </div>
    <img src="imgs/EB.png" class="EB" onerror="this.style.display='none'; createBasket();" />
    <img src="imgs/FB.png" class="FB" onerror="this.style.display='none';" />
    <div id="basketFallback" style="display: none; position: absolute; bottom: 5px; width: 175px; height: 100px; background-color: #8B4513; border-radius: 10px; border: 3px solid #654321;"></div>
    <script>
    function createBasket() {
        const basket = document.getElementById('basketFallback');
        if(basket) basket.style.display = 'block';
    }
    
    // Принудительная загрузка фона через JavaScript для Safari
    window.addEventListener('load', function() {
        const bgImage = 'imgs/background.jpg';
        const bgLayer = document.getElementById('backgroundLayer');
        const body = document.body;
        const html = document.documentElement;
        
        // Проверяем, загрузилось ли изображение
        const img = new Image();
        img.onload = function() {
            // Устанавливаем фон на отдельный div (работает в Safari)
            if (bgLayer) {
                bgLayer.style.backgroundImage = 'url(' + bgImage + ')';
                bgLayer.style.backgroundSize = 'cover';
                bgLayer.style.backgroundPosition = 'center center';
                bgLayer.style.backgroundRepeat = 'no-repeat';
                bgLayer.style.webkitBackgroundSize = 'cover';
            }
            
            // Также устанавливаем на body и html для совместимости
            body.style.backgroundImage = 'url(' + bgImage + ')';
            html.style.backgroundImage = 'url(' + bgImage + ')';
            body.style.backgroundSize = 'cover';
            html.style.backgroundSize = 'cover';
            body.style.backgroundPosition = 'center center';
            html.style.backgroundPosition = 'center center';
            body.style.backgroundRepeat = 'no-repeat';
            html.style.backgroundRepeat = 'no-repeat';
            body.style.backgroundColor = 'transparent';
            html.style.backgroundColor = 'transparent';
            body.style.webkitBackgroundSize = 'cover';
            html.style.webkitBackgroundSize = 'cover';
            
            console.log('Фон загружен успешно в Safari');
        };
        img.onerror = function() {
            console.error('Ошибка загрузки фона:', bgImage);
            // Показываем ошибку пользователю
            if (bgLayer) {
                bgLayer.style.backgroundColor = '#87CEEB';
            }
        };
        img.src = bgImage;
    });
    </script>
  </body>
</html>
